<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> golang questions part I · zbbbbbblog</title><meta name="description" content="golang questions part I - zhiruchen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://zhiruchen.github.io/atom.xml" title="zbbbbbblog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/zhiruchen" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">golang questions part I</h1><div class="post-info">2018年6月14日</div><div class="post-content"><h1 id="Golang-面试题总结-I"><a href="#Golang-面试题总结-I" class="headerlink" title="Golang 面试题总结 I"></a>Golang 面试题总结 I</h1><h2 id="Golang-中goroutine之间用什么来通信的"><a href="#Golang-中goroutine之间用什么来通信的" class="headerlink" title="Golang 中goroutine之间用什么来通信的"></a>Golang 中goroutine之间用什么来通信的</h2><p>用的channel</p>
<h2 id="buffered-channel-vs-unbuffered-channel"><a href="#buffered-channel-vs-unbuffered-channel" class="headerlink" title="buffered channel vs unbuffered channel"></a>buffered channel vs unbuffered channel</h2><ol>
<li><p>buffered channel 有容量, 发送者在channel容量未填满前不会阻塞直到容量满了，接受者在channel未空前不会阻塞直到channel变空。</p>
</li>
<li><p>unbuffered channel 发送者做发送操作之后，同时必须有一个接受者做接受操作。常用来做goroutine之间的同步。</p>
</li>
</ol>
<h2 id="make-vs-new"><a href="#make-vs-new" class="headerlink" title="make vs new"></a>make vs new</h2><p>make: 只用来分配map, slice, channel, 返回一个类型的初始化零值。make初始化这些类型的内部数据结构，为使用做好准备。<br>new: 分配内存，但不初始化。返回类型T的零值指针。</p>
<h2 id="slice-内部结构"><a href="#slice-内部结构" class="headerlink" title="slice 内部结构"></a>slice 内部结构</h2><p>slice 内部有一个指针指向底层的数组，还有长度和容量，分别表示当前slice的元素个数以及从指针开始处到数组末尾的长度。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ss := []<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;</span><br><span class="line">s1 := ss[<span class="number">1</span>:<span class="number">5</span>] <span class="comment">// len(s1)=4, cap(s1) = 6</span></span><br></pre></td></tr></table></figure>
<h2 id="从一个slice中切分出来的slice添加元素对原来的slice是否有影响"><a href="#从一个slice中切分出来的slice添加元素对原来的slice是否有影响" class="headerlink" title="从一个slice中切分出来的slice添加元素对原来的slice是否有影响"></a>从一个slice中切分出来的slice添加元素对原来的slice是否有影响</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ss := []<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;</span><br><span class="line">	s1 := ss[<span class="number">1</span>:<span class="number">5</span>]</span><br><span class="line">	</span><br><span class="line">	fmt.Println(<span class="built_in">len</span>(s1), <span class="built_in">cap</span>(s1))</span><br><span class="line">	fmt.Println(ss, s1)</span><br><span class="line">	</span><br><span class="line">	s1 = <span class="built_in">append</span>(s1, <span class="number">10</span>)</span><br><span class="line">	fmt.Println(<span class="built_in">len</span>(s1), <span class="built_in">cap</span>(s1))</span><br><span class="line">	fmt.Println(ss, s1)</span><br><span class="line">	</span><br><span class="line">	s1 = <span class="built_in">append</span>(s1, <span class="number">11</span>)</span><br><span class="line">	fmt.Println(<span class="built_in">len</span>(s1), <span class="built_in">cap</span>(s1))</span><br><span class="line">	fmt.Println(ss, s1)</span><br><span class="line">	</span><br><span class="line">	s1 = <span class="built_in">append</span>(s1, <span class="number">12</span>)</span><br><span class="line">	fmt.Println(<span class="built_in">len</span>(s1), <span class="built_in">cap</span>(s1))</span><br><span class="line">	fmt.Println(ss, s1)</span><br><span class="line">	</span><br><span class="line">	fmt.Println(<span class="string">"Hello, playground"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">4 6</span></span><br><span class="line"><span class="comment">7 7</span></span><br><span class="line"><span class="comment">[1 2 3 4 5 6 7] [2 3 4 5]</span></span><br><span class="line"><span class="comment">5 6</span></span><br><span class="line"><span class="comment">[1 2 3 4 5 10 7] [2 3 4 5 10]</span></span><br><span class="line"><span class="comment">6 6</span></span><br><span class="line"><span class="comment">7 7</span></span><br><span class="line"><span class="comment">[1 2 3 4 5 10 11] [2 3 4 5 10 11]</span></span><br><span class="line"><span class="comment">7 12</span></span><br><span class="line"><span class="comment">[1 2 3 4 5 10 11] [2 3 4 5 10 11 12]</span></span><br><span class="line"><span class="comment">8 12</span></span><br><span class="line"><span class="comment">7 7</span></span><br><span class="line"><span class="comment">[1 2 3 4 5 10 11] [2 3 4 5 10 11 12 1000]</span></span><br><span class="line"><span class="comment">Hello, playground</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">有影响，会改动原始slice里面元素的值，*但是不会改变原来slice的长度和容量*</span><br></pre></td></tr></table></figure>
<h2 id="说说对goroutine的理解"><a href="#说说对goroutine的理解" class="headerlink" title="说说对goroutine的理解"></a>说说对goroutine的理解</h2><ul>
<li><p>goroutine 是并发运行的function或method</p>
</li>
<li><p>goroutine 是轻量级的线程，创建一个goroutine开销较小。</p>
</li>
<li><p>goroutine 被多路复用到多个os线程上。当一个goroutine出现阻塞的时候，一个新的os thread将被创建去运行其他的运行的goroutine。</p>
</li>
<li><p>goroutine 使用channel来通信。</p>
</li>
</ul>
<h2 id="function-和-method-定义上的区别"><a href="#function-和-method-定义上的区别" class="headerlink" title="function 和 method 定义上的区别"></a>function 和 method 定义上的区别</h2><p>区别就是定义方式不一样</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// method</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v *Type)</span> <span class="title">Method</span><span class="params">()</span></span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// func</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Func</span><span class="params">()</span></span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="defer-的执行顺序"><a href="#defer-的执行顺序" class="headerlink" title="defer 的执行顺序"></a>defer 的执行顺序</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">"defer 1"</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">"defer 2"</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">"defer 3"</span>)</span><br><span class="line">	</span><br><span class="line">	fmt.Println(<span class="string">"main"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">main</span></span><br><span class="line"><span class="comment">defer 3</span></span><br><span class="line"><span class="comment">defer 2</span></span><br><span class="line"><span class="comment">defer 1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">与定义的相反顺序执行</span><br></pre></td></tr></table></figure>
<h2 id="panic-recorver"><a href="#panic-recorver" class="headerlink" title="panic recorver"></a>panic recorver</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> e := <span class="built_in">recover</span>(); e != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">"%T, %v\n"</span>, e, e)</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;()</span><br><span class="line">	</span><br><span class="line">	panicFunc()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">panicFunc</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(<span class="string">"call panic "</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">string, call panic</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h2 id="golang-init-函数的调用"><a href="#golang-init-函数的调用" class="headerlink" title="golang init 函数的调用"></a>golang init 函数的调用</h2><p>golang 中init是在执行main开始前调用的<br>多个init是按照定义的顺序执行的</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> v = setV()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"init 1"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"init 2"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(v)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">setV</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"setV"</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="number">42</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">setV</span></span><br><span class="line"><span class="comment">init 1</span></span><br><span class="line"><span class="comment">init 2</span></span><br><span class="line"><span class="comment">42</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>## </p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/05/30/go-pprof/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="https://zhiruchen.github.io">zhiruchen</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>